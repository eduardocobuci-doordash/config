# Root shell config: loads all other *.conf files.
# Safe to source multiple times.

# Where your per-topic configs live
: "${SHELL_CONFIG_DIR:=${HOME}/.config/shell}"

# Optional: echo whatâ€™s being loaded (toggle with SHELL_CONFIG_VERBOSE=1)
: "${SHELL_CONFIG_VERBOSE:=0}"

# Make globs that don't match expand to nothing (not a literal)
setopt null_glob 2>/dev/null

# Load top-level *.conf first, then nested ones (ordered by filename)
# Exclude root.conf to prevent recursion
for file in "${SHELL_CONFIG_DIR}"/*.conf "${SHELL_CONFIG_DIR}"/**/*.conf; do
  [[ -r "$file" ]] || continue
  # Skip root.conf to prevent recursion
  [[ "$(basename "$file")" == "root.conf" ]] && continue
  (( SHELL_CONFIG_VERBOSE )) && echo "sourcing: $file"
  source "$file"
done

unsetopt null_glob 2>/dev/null

# Handy helper: reload without restarting the shell
reload-configs() {
  source "${HOME}/.config/shell/root.conf"
}